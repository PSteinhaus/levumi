<script>
    //Eintrag in der Navleiste markieren
    highlightNavItem('navbarTests');
</script>

<div id='levumi' data='{}'>

  <!-- Spinner -->
  <div v-if='!$data'>
    <b-row>
      <div class='spinner'>
        <div class='bounce1'></div>
        <div class='bounce2'></div>
        <div class='bounce3'></div>
      </div>
    </b-row>
  </div>

  <b-container fluid>
    <b-row v-cloak class='mt-3'>
      <b-col md='12'>

        <b-tabs pills>

          <% Area.all.each do |a| %>
            <!-- Oberste Ebene Lernbereiche -->
            <b-tab>

              <template slot='title'>
                <%= a.name %>
              </template>

              <b-card no-body class='mt-3'>
                <b-tabs pills card>

                  <!-- Hinweistext falls keine Tests vorhanden -->
                  <div slot='empty'>
                    <div class='text-center text-muted'>
                      Keine Kompetenzbereiche vorhanden.
                    </div>
                  </div>

                  <% a.competences.each do |c| %>
                    <!-- Zweite Ebene Kompetenzen -->
                    <b-tab>

                      <template slot='title'>
                        <%= c.name %>
                      </template>

                      <%= c.description%>

                      <div class='mt-3'>
                        <b-tabs pills>

                          <!-- Hinweistext falls keine Tests vorhanden -->
                          <div slot='empty'>
                            <div class='text-center text-muted'>
                              Keine Tests vorhanden.
                            </div>
                          </div>

                          <% c.test_families.each do |f| %>
                            <!-- Dritte Ebene Tests -->
                            <b-tab>

                              <template slot='title'>
                                <%= f.name %>
                              </template>

                              <%= f.description%>

                              <b-card no-body class='mt-3'>
                                <b-tabs pills card vertical>

                                  <% f.tests.each do |t| %>
                                    <!-- Vierte Ebene Niveaustufen -->
                                    <b-tab>

                                      <template slot='title'>
                                        <%= t.level %>
                                      </template>

                                      <!-- Edit-Button anzeigen, falls Nutzer Berechtigung hat -->
                                      <% if @login.has_capability?('test') %>
                                        <a class='btn btn-outline-secondary float-right'><i class='fas fa-edit'></i> Test bearbeiten</a>
                                      <% end %>

                                      <!-- Testinfo rendern -->
                                      <%= render t %>

                                    </b-tab>
                                  <% end %>

                                </b-tabs>
                              </b-card>

                            </b-tab>
                          <% end %>

                        </b-tabs>
                      </div>

                    </b-tab>
                  <% end %>

                </b-tabs>
              </b-card>

            </b-tab>
          <% end %>

        </b-tabs>

      </b-col>
    </b-row>
  </b-container>
</div>
